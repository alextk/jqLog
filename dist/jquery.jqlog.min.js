/*
* jqLog - jQuery framework extensions
*
* Version: 0.0.1a
* Copyright 2011 Alex Tkachev
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: Fri Jul 8 11:57:03 2011 +0300
*/
(function(a){a.jqLog={classes:{}}})(jQuery),function(a){a.jqLog.Level={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,FATAL:6,isLower:function(b,c){if(a.type(c)==="number")return b<c;return!1}}}(jQuery),function(a){a.jqLog.classes.Logger=function(){this.initialize.apply(this,arguments)},a.extend(a.jqLog.classes.Logger.prototype,{initialize:function(b){a.extend(this,b)},log:function(a,b,c){if(this.jqLog.isLevelEnabled(this,a)){if(c)for(var d in c)b=b.replace("{"+d+"}",c[d]);this.jqLog.doAppend(this,a,b)}}}),["trace","debug","info","warn","error","fatal"].each(function(b){a.jqLog.classes.Logger.prototype[b]=function(){Array.prototype.unshift.call(arguments,a.jqLog.Level[b.toUpperCase()]),this.log.apply(this,arguments)}})}(jQuery),function(a){a.jqLog.classes.LoggersManager=function(){this.initialize.apply(this,arguments)},a.extend(a.jqLog.classes.LoggersManager.prototype,{loggers:null,rootLogger:null,initialize:function(a){this.jqLog=a,this.reset()},reset:function(){this.loggers={},this.rootLogger=this.loggers._logger=new a.jqLog.classes.Logger({jqLog:this.jqLog,name:"",nameArr:[],level:a.jqLog.Level.DEBUG})},configure:function(a){a.root&&(this.rootLogger.level=a.root.level);for(var b in a)if(b!="root"){var c=a[b],d=this.logger(b);c.level&&(d.level=c.level)}},logger:function(b){if(!b||b.length===0)return this.rootLogger;var c=b.split("."),d=this.loggers;for(var e=0;e<c.length;e++){var f=c[e];d[f]||(d[f]={_logger:null}),d=d[f]}d._logger===null&&(d._logger=new a.jqLog.classes.Logger({jqLog:this.jqLog,name:b,nameArr:c}));return d._logger},isLevelEnabled:function(b,c){if(a.jqLog.Level.isLower(c,this.rootLogger.level)||a.jqLog.Level.isLower(c,b.level))return!1;var d=this.loggers;for(var e=0;e<b.nameArr.length;e++){var f=b.nameArr[e];if(d[f]._logger&&d[f]._logger.level&&a.jqLog.Level.isLower(c,d[f]._logger.level))return!1;d=d[f]}return!0}})}(jQuery),function(a){a.jqLog.classes.ConsoleAppender=function(){this.initialize.apply(this,arguments)};var b=a.jqLog.Level,c={};["trace","debug","info","warn","error","fatal"].each(function(a){c[b[a.toUpperCase()]]=a}),a.jqLog.classes.ConsoleAppender.loggingMethodForLevel=function(a){return c[a]||"debug"},a.extend(a.jqLog.classes.ConsoleAppender.prototype,{console:console,initialize:function(b){a.extend(this,b),this.enabled=this.hasConsole()},doAppend:function(b){if(!this.enabled)return!1;var c=a.jqLog.classes.ConsoleAppender.loggingMethodForLevel(b.level);this.console[c](b.message);return!0},hasConsole:function(){return typeof this.console!=="undefined"&&this.console!==null}})}(jQuery),function(a){a.jqLog.classes.JQLog=function(){this.initialize.apply(this,arguments)},a.extend(a.jqLog.classes.JQLog.prototype,{manager:null,appenders:null,rootLogger:null,defaultConfig:null,initialize:function(a){this.defaultConfig=a},reset:function(){this.manager=new a.jqLog.classes.LoggersManager(this),this.rootLogger=this.manager.rootLogger,this.appenders=[],this.configure(this.defaultConfig)},isLevelEnabled:function(a,b){return this.manager.isLevelEnabled(a,b)},doAppend:function(a,b,c){var d={date:new Date,logger:a,level:b,message:c};this.appenders.each(function(a){a.doAppend(d)})},logger:function(a){return this.manager.logger(a)},configure:function(a){a.loggers&&this.manager.configure(a.loggers),a.appenders&&(this.appenders=a.appenders)}}),a.extend(a.jqLog,{defaults:{appenders:[new a.jqLog.classes.ConsoleAppender],loggers:{root:{level:a.jqLog.Level.DEBUG}}}});var b=function(){var b=new a.jqLog.classes.JQLog(a.jqLog.defaults);return{_instance:b,rootLogger:function(){return b.rootLogger},logger:function(a){return b.logger(a)},configure:function(a){b.configure(a)}}}();a.extend(a.jqLog,b)}(jQuery)